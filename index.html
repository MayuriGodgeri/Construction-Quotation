<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pankaj Construction Quotation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
    }

    .header {
      background: linear-gradient(to right, #2d7a32, #4caf50);
      color: white;
      padding: 20px;
      display: flex;
      align-items: center;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
    }

    .header img {
      width: 70px;
      height: 70px;
      margin-right: 20px;
      border-radius: 8px;
    }

    .header div {
      line-height: 1.4;
    }

    .header h1 {
      margin: 0;
      font-size: 26px;
    }

    .header p {
      margin: 3px 0;
      font-size: 14px;
    }

    .container {
      background: white;
      width: 90%;
      max-width: 850px;
      margin: 30px auto;
      padding: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-radius: 0 0 10px 10px;
    }

    label {
      font-weight: bold;
    }

    input {
      padding: 5px;
      margin: 5px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #e8f5e9;
    }

    button {
      background: #388e3c;
      color: white;
      border: none;
      padding: 8px 14px;
      margin: 10px 5px 10px 0;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    button:hover {
      background: #2e7d32;
    }

    .remove-btn {
      background: #e53935;
    }

    .remove-btn:hover {
      background: #c62828;
    }

    h3 {
      color: #2e7d32;
    }

    .bank-details input {
      width: 250px;
      display: block;
    }

    .subtotal {
      text-align: right;
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="https://raw.githubusercontent.com/MayuriGodgeri/Construction-Quotation/main/10001509921.png" alt="Logo">
    <div>
      <h1>Pankaj Construction</h1>
      <p>Hno. 750/A Portawado, Siolim Goa</p>
      <p>Phone: 7796174991</p>
    </div>
  </div>

  <div class="container">
    <div>
      <label>Client Name:</label>
      <input type="text" id="clientName" placeholder="Enter client name" />
      <label>Invoice Date:</label>
      <input type="date" id="invoiceDate" />
    </div>

    <table id="quotationTable">
      <thead>
        <tr>
          <th>Particulars</th>
          <th>Size</th>
          <th>Rate</th>
          <th>Amount</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <button onclick="addRow()">+ Add Row</button>
    <button id="labourBtn" onclick="addLabourColumn()">+ Add Labour Charges</button>

    <div class="subtotal" id="subtotal">Subtotal: ₹ 0.00</div>

    <h3>Receiver Bank Details</h3>
    <div class="bank-details">
      <label>Bank No:</label>
      <input type="text" id="bankNo" placeholder="Enter Bank Number" />
      <label>Bank Name:</label>
      <input type="text" id="bankName" placeholder="Enter Bank Name" />
    </div>

    <button onclick="generatePDF()">Generate PDF</button>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    let hasLabour = false;

    function addRow() {
      const table = document.getElementById("quotationTable").getElementsByTagName('tbody')[0];
      const row = table.insertRow();

      row.innerHTML = `
        <td><input type="text" placeholder="Enter particulars" /></td>
        <td><input type="text" placeholder="Enter size" /></td>
        <td><input type="number" placeholder="Rate" oninput="updateSubtotal()" /></td>
        <td><input type="number" placeholder="Amount" oninput="updateSubtotal()" /></td>
        <td><button class='remove-btn' onclick='removeRow(this)'>X</button></td>
      `;

      if (hasLabour && !row.querySelector(".labour")) {
        const labourCell = row.insertCell(4);
        labourCell.innerHTML = `<input type="number" class="labour" placeholder="Labour" oninput="updateSubtotal()" />`;
        const actionCell = row.insertCell(5);
        actionCell.innerHTML = `<button class='remove-btn' onclick='removeRow(this)'>X</button>`;
      }
      updateSubtotal();
    }

    function removeRow(btn) {
      const row = btn.closest("tr");
      row.remove();
      updateSubtotal();
    }

    function addLabourColumn() {
      if (!hasLabour) {
        const headerRow = document.querySelector("#quotationTable thead tr");
        const labourTh = document.createElement("th");
        labourTh.textContent = "Labour Charges";
        headerRow.insertBefore(labourTh, headerRow.lastElementChild);

        document.querySelectorAll("#quotationTable tbody tr").forEach(row => {
          const cell = row.insertCell(row.cells.length - 1);
          cell.innerHTML = `<input type="number" class="labour" placeholder="Labour" oninput="updateSubtotal()" />`;
        });

        const removeBtn = document.createElement("button");
        removeBtn.textContent = "− Remove Labour Charges";
        removeBtn.id = "removeLabourBtn";
        removeBtn.onclick = removeLabourColumn;
        document.getElementById("labourBtn").after(removeBtn);

        hasLabour = true;
      }
    }

    function removeLabourColumn() {
      const headerRow = document.querySelector("#quotationTable thead tr");
      const labourTh = headerRow.querySelector("th:nth-last-child(2)");
      if (labourTh && labourTh.textContent === "Labour Charges") {
        headerRow.removeChild(labourTh);
      }

      document.querySelectorAll("#quotationTable tbody tr").forEach(row => {
        const labourCell = row.querySelector(".labour");
        if (labourCell) labourCell.closest("td").remove();
      });

      document.getElementById("removeLabourBtn").remove();
      hasLabour = false;
      updateSubtotal();
    }

    function updateSubtotal() {
      let subtotal = 0;
      document.querySelectorAll("#quotationTable tbody tr").forEach(row => {
        const rate = parseFloat(row.cells[2]?.querySelector("input")?.value) || 0;
        const amount = parseFloat(row.cells[3]?.querySelector("input")?.value) || 0;
        const labour = hasLabour ? parseFloat(row.querySelector(".labour")?.value) || 0 : 0;
        subtotal += rate + amount + labour;
      });
      document.getElementById("subtotal").textContent = `Subtotal: ₹ ${subtotal.toFixed(2)}`;
    }

    async function generatePDF() {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF("p", "pt", "a4");
      const element = document.querySelector(".container");
      const canvas = await html2canvas(element);
      const imgData = canvas.toDataURL("image/png");
      const imgWidth = 550;
      const pageHeight = 780;
      const imgHeight = canvas.height * imgWidth / canvas.width;
      let heightLeft = imgHeight;
      let position = 0;
      pdf.addImage(imgData, "PNG", 25, position, imgWidth, imgHeight);
      heightLeft -= pageHeight;
      while (heightLeft >= 0) {
        position = heightLeft - imgHeight;
        pdf.addPage();
        pdf.addImage(imgData, "PNG", 25, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;
      }
      pdf.save("Quotation.pdf");
    }
  </script>
</body>
</html>

